# Fire Detection AI Project

## 프로젝트 소개

본 프로젝트는 실시간으로 산불을 감지하고 위험 수준을 평가하기 위한 AI 시스템을 구축하는 것을 목표로 합니다. 드론 카메라를 이용하여 실시간으로 영상 데이터를 분석하고, 불과 연기를 감지하여 산불의 초기 징조를 신속하게 포착하는 것이 주요 목적입니다. 

### 프로젝트 주요 기능
1. **실시간 산불 탐지**: 영상 데이터를 실시간으로 분석하여 불과 연기를 감지합니다.
2. **위험 수준 분석**: 감지된 산불의 규모와 범위를 이용하여 현재 산불의 위험 수준을 평가합니다.
3. **카메라 기반 탐지**: 드론 카메라만을 이용하여 다른 센서 없이 산불 상황을 파악합니다.

## AI 모델 구조

- **YOLOv9 기반**: 본 프로젝트는 YOLOv9 모델을 기반으로 학습하였으며, 경량화 및 Fine-tuning을 통해 모델의 효율성을 극대화했습니다. Tensorrt를 적용하여 추론 속도를 향상시켰습니다.
- **Depth 기술 적용**: Pre-trained된 Monocular Depth 모델을 사용하여 YOLO 학습에 사용한 데이터와 동일한 데이터로 Fine-tuning을 진행하였습니다. Depth값과 Bbox의 크기, Bbox의 개수를 이용해 현재 화재 상황의 위험도를 평가합니다.
- **영상 처리 알고리즘**: YOLO 모델의 추론 속도를 개선하기 위해 Tensorrt를 이용해 경량화를 수행했습니다.

## Pruning 과정 및 결과

모델 경량화를 위해 Pruning을 진행하고, Fine-tuning을 적용하여 모델 성능을 비교했습니다.

| 모델 종류 | Precision | Recall | mAP50 | mAP50-95 | Inference Speed (ms) |
|-----------|-----------|--------|--------|----------|----------------------|
| Just Training (All) | 0.846 | 0.808 | 0.866 | 0.511 | 222.88 |
| Dynamic Pruning (All) | 0.824 | 0.822 | 0.863 | 0.504 | 216.68 |
| Pruning + Fine-tuning (All) | 0.825 | 0.811 | 0.854 | 0.497 | 215.37 |

## Tensorrt 적용 결과

Tensorrt를 적용하여 모델의 추론 성능을 개선했습니다.

| 모델 종류 | Precision | Recall | mAP50 | mAP50-95 | Inference Speed (ms) |
|-----------|-----------|--------|--------|----------|----------------------|
| Pruning + Tensorrt (All) | 0.836 | 0.807 | 0.85 | 0.491 | 197.89 |
| Pruning (All) | 0.84 | 0.8 | 0.853 | 0.493 | 215.97 |
| Original (All) | 0.825 | 0.815 | 0.864 | 0.504 | 221.32 |

## 결과 영상 시연

![결과 영상](./runs/detect/yolov9_17_detect8/test2.jpg)
- 최종 모델을 이용한 산불 감지 결과는 아래의 결과 영상으로 확인할 수 있습니다.

## 사용 기술 및 도구
- **프로그래밍 언어**: Python
- **플랫폼**: Ubuntu (Jetson Orin)
- **모델 및 도구**: YOLOv9, Gradio, Docker, TensorRT, Monocular Depth 알고리즘



